{
  "hash": "4326705657b583f47b4c2ef667f2c164",
  "result": {
    "markdown": "---\ntitle: 'Principal Component Analysis `<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 576 512\" style=\"height:1em;width:1.12em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M264.5 5.2c14.9-6.9 32.1-6.9 47 0l218.6 101c8.5 3.9 13.9 12.4 13.9 21.8s-5.4 17.9-13.9 21.8l-218.6 101c-14.9 6.9-32.1 6.9-47 0L45.9 149.8C37.4 145.8 32 137.3 32 128s5.4-17.9 13.9-21.8L264.5 5.2zM476.9 209.6l53.2 24.6c8.5 3.9 13.9 12.4 13.9 21.8s-5.4 17.9-13.9 21.8l-218.6 101c-14.9 6.9-32.1 6.9-47 0L45.9 277.8C37.4 273.8 32 265.3 32 256s5.4-17.9 13.9-21.8l53.2-24.6 152 70.2c23.4 10.8 50.4 10.8 73.8 0l152-70.2zm-152 198.2l152-70.2 53.2 24.6c8.5 3.9 13.9 12.4 13.9 21.8s-5.4 17.9-13.9 21.8l-218.6 101c-14.9 6.9-32.1 6.9-47 0L45.9 405.8C37.4 401.8 32 393.3 32 384s5.4-17.9 13.9-21.8l53.2-24.6 152 70.2c23.4 10.8 50.4 10.8 73.8 0z\"/></svg>`{=html}'\nsubtitle: \"MATH/COSC 3570 Introduction to Data Science\"\nauthor: \"Dr. Cheng-Han Yu <br> Department of Mathematical and Statistical Sciences <br> Marquette University\"\n# date: \"December 23 2023\"\n# macros: _macros.tex # import a list of TeX/LaTeX definitions\nformat: \n  revealjs:\n    # code-line-numbers: false\n    #     - \"macros.tex\"\n    html-math-method:\n      method: mathjax\n      url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\n    # include-in-header:\n    highlight-style: arrow\n    code-block-bg: true\n    self-contained: false\n    slide-number: c/t    \n    incremental: false\n    width: 1800\n    height: 1000\n    margin: 0.05\n    logo: \"https://upload.wikimedia.org/wikipedia/commons/e/e8/Marquette_Golden_Eagles_logo.svg\"\n    footer: \"[math3570-s24.github.io/website](https://math3570-s24.github.io/website/)\"\n    theme: [\"simple\", \"slides.scss\"]\n    multiplex: true\n    code-link: true\n    fig-cap-location: bottom\n    fig-align: center\n    transition: none ## fade slide convex concave zoom\n    title-slide-attributes:\n      data-background-color: \"#447099\"\n      # data-background-image: images/paper-texture.jpg\n      # data-background-size: cover\n      # data-background-color: \"#698ED5\"\neditor: source\nexecute:\n  freeze: true\n  echo: true\n---\n\n\n#  {visibility=\"hidden\"}\n\n\\def\\bx{\\mathbf{x}}\n\\def\\bg{\\mathbf{g}}\n\\def\\bw{\\mathbf{w}}\n\\def\\bbeta{\\boldsymbol \\beta}\n\\def\\bX{\\mathbf{X}}\n\\def\\by{\\mathbf{y}}\n\\def\\bH{\\mathbf{H}}\n\\def\\bI{\\mathbf{I}}\n\\def\\bS{\\mathbf{S}}\n\\def\\bW{\\mathbf{W}}\n\\def\\T{\\text{T}}\n\\def\\cov{\\mathrm{Cov}}\n\\def\\cor{\\mathrm{Corr}}\n\\def\\var{\\mathrm{Var}}\n\\def\\E{\\mathrm{E}}\n\\def\\bmu{\\boldsymbol \\mu}\n\\DeclareMathOperator*{\\argmin}{arg\\,min}\n\\def\\Trace{\\text{Trace}}\n\n\n\n\n\n\n\n\n\n\n# Unsupervised Learning\n\n## Unsupervised Learning\n- **Supervised Learning**: response $Y$ and features $X_1, X_2, \\dots, X_p$ measured on $n$ observations.\n\n- **Unsupervised Learning**: only features $X_1, X_2, \\dots, X_p$ measured on $n$ observations.\n    + Not interested in prediction (no response to be predicted)\n    + Discover any interesting pattern or relationships among these features.\n\n<!-- . . . -->\n\n<!-- + Estimate the [density, covariance, graph (network)]{.green}, etc. of $\\bX$ -->\n\n. . .\n\n+ [**Dimension reduction**]{.green} for effective data visualization or extracting most important information those features contain.\n    - <span style=\"color:blue\">plot a bunch of points of $\\boldsymbol{x} = (x_1, x_2, \\dots, x_p)$ in a 2-D scatter plot (manifold). (reduce dimension from $p$ to 2)</span>\n    - <span style=\"color:blue\"> use 2 variables to explain most variations or represents high data density in the $p$ variables </span>\n  \n. . .\n\n+ [**Clustering**]{.green} discovers unknown subgroups/clusters in data\n    - <span style=\"color:blue\">find 3 sub-groups of people based on variables income, occupation, age, etc</span>\n    \n    \n# Background: Dimensions\n\n<h3> Going to be very SIMPLE! </h3>\n\n. . .\n\n<h3> But you'll be happy I did this. </h3>\n\n. . .\n\n<h3> Because PCA is about reducing dimensions! </h3>\n\n\n\n\n<!-- #### Because PCA is about reducing dimensions! -->\n\n\n## One-Dimension (1D) Number line\n\n:::: {.columns}\n\n::: {.column width=\"30%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```{.my_class600}\n# A tibble: 50 × 1\n   English\n     <int>\n 1      41\n 2      65\n 3      55\n 4      94\n 5      66\n 6      85\n 7      44\n 8      44\n 9      67\n10      73\n# ℹ 40 more rows\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"70%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-3-1.png){fig-align='center' width=100%}\n:::\n:::\n\n:::\n::::\n\n:::notes\n- Let's go back to your first grade. You remember that one-dimension equals a number line.\n- Now suppose we have 50 English grades. The first 3 scores are 41, 65, and 55. \n- We can plot these values on the number line just like we did in the elementary school.\n- 1st student with score 41 it's a dot at 41, 2nd student with score 65, it's a dot at 65, and so on.\n:::\n\n## One-Dimension (1D) Number line: Uniform students\n:::: {.columns}\n\n::: {.column width=\"30%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```{.my_class600}\n# A tibble: 50 × 1\n   English\n     <int>\n 1      41\n 2      65\n 3      55\n 4      94\n 5      66\n 6      85\n 7      44\n 8      44\n 9      67\n10      73\n# ℹ 40 more rows\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"70%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-5-1.png){fig-align='center' width=100%}\n:::\n:::\n\n:::\n::::\n\n::: notes\n- If you plot all students scores, we might see something like this: an uniform distribution of English scores.\n:::\n\n\n## 1D Number line: Non-uniform students\n:::: {.columns}\n\n::: {.column width=\"30%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```{.my_class600}\n# A tibble: 50 × 1\n   English\n     <int>\n 1      77\n 2      78\n 3      81\n 4      78\n 5      52\n 6      62\n 7      47\n 8      58\n 9      43\n10      59\n# ℹ 40 more rows\n```\n:::\n:::\n\n:::\n\n\n::: {.column width=\"70%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-6-1.png){fig-align='center' width=100%}\n:::\n:::\n\n:::\n::::\n\n\n::: notes\n- Or we might get a non-uniform distribution of English scores. Some students obtain a very high grade, but some students are falling behind and get a very low grade.\n:::\n\n## Two-Dimensions (2D) X-Y Scatter plot: High Correlated\n\nEnglish and Math measure an overall academic performance.\n\n\n:::: {.columns}\n\n::: {.column width=\"30%\"}\n\n\n::: {.cell layout-align=\"center\" highlight.output='4'}\n::: {.cell-output .cell-output-stdout}\n```{.my_class600}\n# A tibble: 50 × 2\n   English  Math\n     <int> <dbl>\n 1      41  33.2\n 2      65  63.6\n 3      55  44.6\n 4      94  95  \n 5      66  65.6\n 6      85  73.1\n 7      44  46.6\n 8      44  51  \n 9      67  69.4\n10      73  66.5\n# ℹ 40 more rows\n```\n:::\n:::\n\n:::\n\n\n::: {.column width=\"70%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-8-1.png){fig-align='center' width=65%}\n:::\n:::\n\n:::\n::::\n\n\n\n::: notes\n- Now let's go to sixth grade when we learned about 2 dimensional graphs.\n- Now we have two axes instead of one, and now we can plot data from two different subjects instead of just one.\n- Additional to English scores, here we also have Math scores of some students.\n- And we all know how to map a English and math score pair to a point on a 2D plot.\n- If we put all students English and Math scores on the plot, we might see something like this that English and Math scores are positively correlated, meaning that a student having high English score tends to have high Math score too. \n- This might be due to the fact that English and Math measure an overall academic performance. A good student tends to have both high English and Math scores.\n:::\n\n## Two-Dimensions (2D) X-Y Scatter plot: No correlated\n\nEnglish and Math measure different abilities.\n\n:::: {.columns}\n\n::: {.column width=\"30%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```{.my_class600}\n# A tibble: 50 × 2\n   English  Math\n     <int> <int>\n 1      41    27\n 2      65    47\n 3      55    32\n 4      94    44\n 5      66    20\n 6      85    30\n 7      44    16\n 8      44    72\n 9      67    86\n10      73    82\n# ℹ 40 more rows\n```\n:::\n:::\n\n:::\n\n\n::: {.column width=\"70%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-10-1.png){fig-align='center' width=65%}\n:::\n:::\n\n:::\n::::\n\n::: notes\n- Or we might see English and Math scores are not correlated, meaning that a high English score does not tell us anything about Math score, whether it is high or low.\n- Because English and Math might measure different abilities. \n- English measures verbal and communication skills and Math measures logic and quantitative skills\n:::\n\n## Three-Dimensions (3D) X-Y-Z Scatter plot\n:::: {.columns}\n\n::: {.column width=\"35%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```{.my_class600}\n# A tibble: 50 × 3\n   English  Math Biology\n     <int> <dbl>   <dbl>\n 1      41  33.2    39.2\n 2      65  63.6    61.6\n 3      55  44.6    41.6\n 4      94  95      92  \n 5      66  65.6    73.6\n 6      85  73.1    71.1\n 7      44  46.6    56.6\n 8      44  51      56  \n 9      67  69.4    79.4\n10      73  66.5    59.5\n# ℹ 40 more rows\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"65%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-12-1.png){fig-align='center' width=100%}\n:::\n:::\n\n:::\n::::\n\n\n::: notes\n- OK. Now maybe in college, we started drawing 3D graph, having height, width and depth.\n- With 3 separate axes, we can now plot data from three different subjects.\n- So now we have three subjects, English, Math and Biology.\n- With the same logic as 2D plot, we put English score on X-axis, Math score on Y-axis, and biology score on Z-axis, then draw lines perpendicular to each axis to put the point in the 3D space.\n- And this is our 3D scatter plot.\n- So, if we have one subject data, we can make a 1D graph.\n- If we have two subject data, we can make a 2D graph.\n- If we have three subject data, we can make a 3D graph.\n:::\n\n\n\n\n---\n## Four-Dimensions (4D) X-Y-Z-? Scatter plot\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```{.my_class600}\n# A tibble: 50 × 4\n   English  Math Biology History\n     <int> <dbl>   <dbl>   <dbl>\n 1      41  33.2    39.2      51\n 2      65  63.6    61.6      53\n 3      55  44.6    41.6      63\n 4      94  95      92        83\n 5      66  65.6    73.6      51\n 6      85  73.1    71.1      74\n 7      44  46.6    56.6      34\n 8      44  51      56        33\n 9      67  69.4    79.4      76\n10      73  66.5    59.5      74\n# ℹ 40 more rows\n```\n:::\n:::\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-14-1.png){fig-align='center' width=100%}\n:::\n:::\n:::\n::::\n\n::: notes\n- But what happens if we have data from 4 academic subjects?? here English, Math, Biology and History.\n- Well we need 4D graph. The problem is You can't draw a 4D plot on paper!\n- What if a student has 20 different grades from 20 different courses?? We need a 20 dimensional graph? \n- But what is that?? There is no way we can draw that.\n:::\n\n## How about Pair Plots?\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-15-1.png){fig-align='center' width=100%}\n:::\n:::\n\n::: notes\n- Plotting all 2-D scatter plots of all possible pairs might be a solution to check the relationship between variables, or exploratory data analysis.\n- Like here we see basically any two variables or two subject scores are positively correlated.\n:::\n\n\n## Tooooo Many Pair Plots!\n\n- If we have $p$ variables, there are ${p \\choose 2} = p(p-1)/2$ pairs.\n- If $p = 10$, we have 45 such scatter plots to look at!\n- In real data science work, we may encounter over 100 variables!!\n\n::: notes\n- But still, there is a problem. \n- If you have $p$ variables, you are gonna have ${p \\choose 2} = p(p-1)/2$ pairs.\n- If $p = 10$, you have 45 such scatter plots to look at!\n- Not to mention that in real data science work, you may encounter over 100 variables!!\n:::\n\n\n\n## Dimension Reduction\n- One variable represents one **dimension**.\n\n- With many variables in the data, we live in a **high dimensional** world.\n\n. . .\n\nGOAL:\n\n- Find a *low-dimensional* (usually 2D) representation of the data that captures [*as much of the information all of those variables provide as possible*]{.green}.\n\n- Use two [*created*]{.green} variables to represent all $p$ variables, and make a scatter plot of the two created variables to learn what our observations look like as if they lived in the high dimensional space.\n<!-- - But why and when can we omit dimensions? -->\n\n. . .\n\n:::{.question}\nWhy and when can we omit dimensions?\n:::\n\n\n\n::: notes\n- So in order to meaningfully represent the relationship of all variables, we need a technique, Dimension Reduction.\n- In mathematics, One variable represents one **dimension**, so with many variables in the data, we live in a **high dimensional** world.\n- We would like to find a *low-dimensional* (usually 2D) representation of the data that captures as much of the information all of those variables provide as possible.\n- We use two *created* variables to represent all $p$ variables, and make a scatter plot of the two created variables to learn what our observations look like as if they lived in the high dimensional space.\n- Of course, it's not always a good idea to just use two variables to represent all $p$ variables. Some information will be missing when we just use two variables to represent or explain all the relationships of $p$ variables.\n- But sometimes, a *low-dimensional* representation looks very like a **high dimensional** space, and does not lose much information. In this situation, a *low-dimensional* representation is very useful.\n- So Let's see why and when can we omit dimensions?\n:::\n\n\n\n## Variation mostly from One Variable \n- Almost all of the variation in the data is from left to right.\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-16-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n::: notes\n- Let's suppose we have two variables, and their data look like this. \n- Here we see almost all of the variation in the data from left to right.\n- It means that for variable X, some observations have low values, and some observations have high values.\n- But it looks like all observations have variable Y at about the same level.\n- Since X varies more than Y, having larger variation, X contains more information than Y in the data.\n:::\n\n\n## Variation mostly from One Variable \n- If we flattened the data, the graph would not look much different.\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-17-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n::: notes\n- If we flattened the data, removing the up and down variation, our graph would not look much different from what it look like before.\n- Most of the variation, or information is still kept in the data.\n:::\n\n\n## Variation mostly from One Variable \n- If we flattened the data, we could graph it with a 1D number line!\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-18-1.png){fig-align='center' width=75%}\n:::\n:::\n\n::: notes\n- Now, with up-and-down variation removed, the variable Y becomes redundant, and we can just represent the flattened data using 1D single number line.\n<!-- - If we flattened the data, we could just graph it with a 1D single number line! -->\n:::\n\n\n## Variation mostly from One Variable \n- Both graphs say *\"the important variation is left to right.\"*\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-19-1.png){fig-align='center' width=75%}\n:::\n:::\n\n\n::: notes\n- So in this case, we can display 2D data on a 1D plot without losing too much information!\n- Both graphs say *\"the important variation is left to right.\"*\n- Another example is watching TV. TV is a 2D thing, but we watch TV for 3D shows. The 2D TV represents the 3D shows, programs or drama very well because the 2D representation does not lose much information the 3D shows provide.\n- So through the example, we know some dimensions are more important than others. Like here Variable X is more important than variable Y because variable X explains most of the variation stored in the data.\n:::\n\n\n\n## 3D Drawing on Paper {visibility=\"hidden\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/19-pca/drawing.png){fig-align='center' width=100%}\n:::\n:::\n\n::: notes\n- 3D Drawing on Paper is another example of dimension reduction. We can create a 2D representation of some object on a piece of paper, as if the object lived in the 3D space.\n- The reason why this 2D representation is so good is because it captures most of the information contained the 3D object, and we don't need one more dimension to describe that object.\n:::\n\n# Principal Component Analysis (PCA)\n\n\n## Idea of PCA\n- PCA is a dimension reduction tool that finds a low-dimensional representation of a data set that contains [as much as possible of *variation*]{.green}.\n\n- Each of the observations lives in a high-dimensional space (lots of variables), but not all of these dimensions (variables) are equally *interesting/important*.\n\n- The concept of *interesting/important* is measured by *the amount that the data vary along each dimension.*\n\n::: notes\n- PCA is a dimension reduction tool that finds a low-dimensional representation of a data set that contains as much as possible of *variation* stored in the data set.\n- As we've seen before, each of the observations lives in a high-dimensional space, meaning that each observation has lots of variables associated with it, but not all of these dimensions (variables) are equally *interesting/important*.\n- The concept of *interesting/important* is measured by the amount that the observations vary along each dimension. \n- A characteristic or attribute of observations is called variable because its value varies from sample to sample.\n- If the variable does not vary, it becomes an irrelevant or un-important variable because we cannot use the variable to differentiate or distinguish observations. If everyone in this class gets grade A, then the data science grade is not an important variable to learn which students perform academically better than others.\n:::\n\n## PCA Illustration: 2 Variable Example\n\n:::: {.columns}\n\n::: {.column width=\"30%\"}\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```{.my_classfull}\n# A tibble: 50 × 2\n   English  Math\n     <int> <dbl>\n 1      41  33.2\n 2      65  63.6\n 3      55  44.6\n 4      94  95  \n 5      66  65.6\n 6      85  73.1\n 7      44  46.6\n 8      44  51  \n 9      67  69.4\n10      73  66.5\n11      47  58.9\n12      66  66.5\n13      57  51  \n14      57  33.2\n15      77  83.6\n16      83  78.8\n# ℹ 34 more rows\n```\n:::\n:::\n:::\n\n::: {.column width=\"70%\"}\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-22-1.png){fig-align='center' width=70%}\n:::\n:::\n:::\n::::\n\n\n::: notes\n- We use the English and Math score example to illustrate how PCA works.\n- From the data, we have a 2D scatter plot like this.\n- With the data, we can have the average of English score and the average of math score, shown as the red squared point in the scatter plot.\n:::\n\n\n## Step 1: Shift (or standardize) the Data\n- So the two variables have both mean 0. If the variables are measured in a different unit, consider standardization, $\\frac{x_i - \\bar{x}}{s_x}$.\n- Shifting does not change how the data points are positioned *relative* to each other.\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-23-1.png){fig-align='center' width=75%}\n:::\n:::\n:::\n\n\n\n::: {.column width=\"50%\"}\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-24-1.png){fig-align='center' width=75%}\n:::\n:::\n:::\n::::\n\n::: notes\n- PCA first shift or standardize our data so that the center is on top of the origin (0, 0) in the graph. \n- If the two variables are measured in a different scale, standardization is highly recommended. Here because both English and Math scores are measured using the same scale. We only do the shifting, and no scaling.\n- After standardization, all variables will use the same scale to measure their variation, and that makes more sense because PCA wants to find some axis or coordinate lower dimensional representation that contains the most variation, and we don't want the variation depends on variable's measurement units.\n- Notice that Shifting does not change how the data points are positioned *relative* to each other. The scattering shape remains the same.\n:::\n\n\n## Step 2: Find a Line that Fits the Data the Best\n\n- Start with a line *going through the origin*.\n- **Rotate** the line until it fits the data as well as it can, given that it goes through the origin.\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-25-1.png){fig-align='center' width=48%}\n:::\n:::\n\n::: notes\n- The second step of PCA is going to fit a line to the centered or normalized data set.\n<!-- - Now that the data are centered on the origin, we can try to fit a line to it. -->\n- To do this, we start by drawing a random line that goes through the origin.\n:::\n\n\n## Step 2: Find a Line that Fits the Data the Best\n- Start with a line *going through the origin*.\n- **Rotate** the line until it fits the data as well as it can, given that it goes through the origin.\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-26-1.png){fig-align='center' width=48%}\n:::\n:::\n\n::: notes\n- Then we rotate the line until if fits the data as well as it can, given that it has to go through the origin.\n:::\n\n\n## Step 2: Find a Line that Fits the Data the Best\n- Start with a line *going through the origin*.\n- **Rotate** the line until it fits the data as well as it can, given that it goes through the origin.\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-27-1.png){fig-align='center' width=41%}\n:::\n:::\n\n::: notes\n- Ultimately, this line fits best. \n<!-- - Last time we stopped here, we haven't learned what criterion makes the line the best fit. -->\n- So let's see what makes this line the best fit, and the meaning of this line.\n<!-- - But here, I jump to the conclusion too quickly. First we need to talk about how PCA decides if a fit is good or not. -->\n:::\n\n\n\n## The Meaning of the Best line\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- The best line [*maximizes the variance of the projected points*]{.green} from the data points onto the line! It is called the **1st Principal Component (PC1)**\n\n- PC1 is the line in the Eng-Math space that is *closest* to the $n$ observations\n  + *PC1 minimizes the sum of squared distances between the data points and the PC1.*\n\n- **<span style=\"color:red\">PC1 is the best 1D representation of the 2D data</span>**\n:::\n\n\n\n::: {.column width=\"50%\"}\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-28-1.png){fig-align='center' width=100%}\n:::\n:::\n:::\n::::\n\n\n\n::: notes\n- To quantify how good this line fits the data, PCA projects the data onto it.\n- Then the idea is that we can either measure the distances from the data to the line and try to find the line that minimizes those distances.\n- Or we can try to find the line that maximizes the distances from the projected points to the origin.\n- The two criteria are equivalent.\n- DEMO\n- So we are find the line that **maximizes the variation of the projected points from the data points onto the line**!\n- The best line is called **Principal Component 1 (PC1)**, which **maximizes the sum of squared distances between projected points and the origin.**\n- Regression line: minimizes the sum of squared residuals (vertical lines from the data points to the line)\n- **Principal Component 1 (PC1)**: maximizes the sum of squared distances between between projected points and the origin.\n- PC1 is the line in the Eng-Math 2 dimensional space that is **closest** to the $n$ observations, i.e., PC1 minimizes the sum of squared distances between the data points and the PC1. \n- **<span style=\"color:red\">PC1 is the best 1D representation of the 2D data</span>**\n:::\n\n\n## The Meaning of the Best line\n\n:::{.small}\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![https://stats.stackexchange.com/questions/2691/making-sense-of-principal-component-analysis-eigenvectors-eigenvalues](./images/19-pca/pca.gif){fig-align='center' width=100%}\n:::\n:::\n:::\n\n::: notes\n- I am going to conclude the idea of PCA using this gif.\n- This gif shows you the idea of finding principal components.\n- As the line rotates, you can see the locations of the projected points on the line keeps changing as well.\n- And the PC1 is the line that maximizes the variation of the projected points.\n- Also, the PC1 is the line that minimizes the distance between the data points and the line. In the figure, the sum of those red lines will be the smallest.\n- Questions?\n:::\n\n## PC1 and PC2\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- The data points are also spread out a little above and below the PC1.\n- There are some variation that is not explained by the PC1.\n- Find the second PC, PC2, that \n  + explains the remaining variation\n  + is the line *through the origin and perpendicular to PC1*.\n:::\n\n\n\n::: {.column width=\"50%\"}\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-30-1.png){fig-align='center' width=100%}\n:::\n:::\n:::\n::::\n\n\n::: notes\n- Along with the PC1, the data points are also spread out a little above and below the PC1.\n- There are some variation of the two variables that is not explained by the PC1.\n- To find another PC that explains the remaining variation, we find the second PC, called PC2 that is the line **through the origin and perpendicular to PC1**.\n:::\n \n## Rotate Everything so that PC1 is Horizontal {visibility=\"hidden\"}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n**1D representation**\n\n- PC1 is our 1D number line that explains the most variation contained in 2D data using a 1D line.\n- Points on the PC1 are the projected points of data onto PC1.\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-31-1.png){fig-align='center' width=100%}\n:::\n:::\n:::\n\n\n::: {.column width=\"50%\"}\n\n**2D representation**\n\n- The new coordinates PC1 and PC2 are ordered by variation size of the English and Math scores\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-32-1.png){fig-align='center' width=78%}\n:::\n:::\n:::\n::::\n\n::: notes\n- If we make PC1 and PC2 the new X-Y coordinates, the new coordinates PC1 and PC2 are ordered by variation size of the English and Math scores.\n- PC1 is our 1D number line that explains the most variation contained in 2D data using a 1D line.\n- Points on the PC1 are the projected points of data onto PC1.\n- PC1 explains the most variation, and PC2 explains the second most variation.\n- And PC2 explains the remaining variations that are not explained by PC1.\n- Here, because we only have 2 dimensions, we have at most 2 PCs. \n:::\n\n\n## Linear Combinations\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-33-1.png){fig-align='center' width=100%}\n:::\n:::\n:::\n\n::: {.column width=\"50%\"}\n- PC1 = 0.68 $\\times$ English $+$ 0.74 $\\times$ Math\n- PC2 = 0.74 $\\times$ English $-$ 0.68 $\\times$ Math\n- PC1 is like an **overall intelligence index**  as it is a *weighted* average combining verbal and quantitative abilities.\n- PC2 accounts for individual difference in English and Math scores.\n<!-- - $0.68^2 + 0.74^2 = 1$ (Pythagorean theorem) -->\n- The combination weights 0.68, 0.74, etc are called PC **loadings**. \n:::\n::::\n\n::: notes\n- Now let's look at PC1 and PC2 a little more carefully. \n- First PC1 and PC2 are just a vector in 2 dimensional space, right?\n- In other words, they are linear combinations of two standard basis, here our English axis and Math axis. \n- PCA help us get the linear combinations.\n- Here PC1 = 0.68 $\\times$ English + 0.74 $\\times$ Math\n- PC2 = 0.74 $\\times$ English - 0.68 $\\times$ Math\n- So to make PC1, we mix 0.68 part of English score with 0.74 parts of Math score. \n- One unit of PC1 consists of 0.68 parts of English and 0.74 parts of Math.\n- And because the weight of math score is a little bit larger, Math score is a little bit more important when it comes to describing how the data are spread out. \n- PC1 can be viewed as an **overall intelligence index** because it is an weighted average combining both verbal and quantitative reasoning abilities.\n- PC2 accounts for individual difference in English and Math scores.\n- $0.68^2 + 0.74^2 = 1$ (Pythagorean theorem)\n- The combination weights 0.68, 0.74, etc are called **loadings** of PC.\n<!-- - (0.68, 0.74): e-vector of PC1. -->\n<!-- - One unit of PC1 consists of 0.68 parts of English and 0.74 parts of Math.  -->\n<!-- - One unit of PC2 consists of 0.74 parts of English and -0.68 parts of Math. -->\n:::\n\n\n\n\n\n## Variation\n\n<!-- - Variation for PC1 $= \\frac{\\text{Sum of squared distances of projected points on PC1}}{n-1}$  -->\n\n<!-- - Variation for PC2 $= \\frac{\\text{Sum of squared distances of projected points on PC2}}{n-1}$  -->\n\n- If the variance for PC1 is $17$ and the variance for PC2 is $2$, the total variation presented in the data is $17+2=19$.\n\n- PC1 accounts for $17/19 = 89\\%$ of the total variation, and PC2 accounts for $2/19 = 11\\%$ of the total variation.\n\n\n::: notes\n- OK how do we quantify variation. Let's give it a definition.\n- Variation for PC1 $= \\frac{\\text{Sum of squared distances of projected points on PC1}}{n-1}$ \n- Variation for PC2 $= \\frac{\\text{Sum of squared distances of projected points on PC2}}{n-1}$ \n- If the variation for PC1 is $17$ and the variation for PC2 is $2$, the total variation presented in the data is $17+2=19$.\n- PC1 accounts for $17/19 = 89\\%$ of the total variation, and PC2 accounts for $2/19 = 11\\%$ of the total variation.\n:::\n\n\n\n## How about 3 or More Variables? \n- PC1 spans the direction of the most variation\n\n. . .\n\n- PC2 spans the direction of the 2nd most variation\n\n. . .\n\n- PC3 spans the direction of the 3rd most variation\n\n. . .\n\n- PC4 spans the direction of the 4th most variation\n\n. . .\n\n- If we have $n$ observations and $p$ variables (dimensions), there are at most $\\min(n - 1, p)$ PCs.\n\n\n::: notes\n- OK. We use a 2D data to illustrate PCA. How about 3 or More Variables? \n- Well the idea of 2D data can be exactly applied to 3 or more dimensional data.\n:::\n\n\n## US Arrest Data in 1973\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndim(USArrests)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 50  4\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\" highlight.output='1'}\n\n```{.r .cell-code}\nhead(USArrests, 16)\n```\n\n::: {.cell-output .cell-output-stdout}\n```{.my_classfull}\n            Murder Assault UrbanPop Rape\nAlabama       13.2     236       58   21\nAlaska        10.0     263       48   44\nArizona        8.1     294       80   31\nArkansas       8.8     190       50   20\nCalifornia     9.0     276       91   41\nColorado       7.9     204       78   39\nConnecticut    3.3     110       77   11\nDelaware       5.9     238       72   16\nFlorida       15.4     335       80   32\nGeorgia       17.4     211       60   26\nHawaii         5.3      46       83   20\nIdaho          2.6     120       54   14\nIllinois      10.4     249       83   24\nIndiana        7.2     113       65   21\nIowa           2.2      56       57   11\nKansas         6.0     115       66   18\n```\n:::\n:::\n\n::: notes\n- OK. Time to learn how to perform PCA in R.\n- The data set used for PCA is USArrests data set in 1973.\n- Each observation or subject is a state, and we have 4 features or dimensions, Murder, Assault, UrbanPop, and Rape.\n:::\n\n\n\n## PC Loading Vectors on `USArrests`\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npca_output <- prcomp(USArrests, scale = TRUE)\n\n## rotation matrix provides PC loadings\n(pca_output$rotation <- -pca_output$rotation)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          PC1   PC2   PC3    PC4\nMurder   0.54  0.42 -0.34 -0.649\nAssault  0.58  0.19 -0.27  0.743\nUrbanPop 0.28 -0.87 -0.38 -0.134\nRape     0.54 -0.17  0.82 -0.089\n```\n:::\n:::\n\n\n- PCs are unique up to a sign change, so `-pca_output$rotation` gives us the same PCs as `pca_output$rotation` does. \n\n. . .\n\n$\\text{PC1} = 0.54 \\times \\text{Murder} + 0.58 \\times \\text{Assault} + 0.28 \\times \\text{UrbanPop} + 0.54 \\times \\text{Rape}$\n\n<br>\n\n$\\text{PC2} = -0.42 \\times \\text{Murder} - 0.19 \\times \\text{Assault} + 0.87 \\times \\text{UrbanPop} + 0.17 \\times \\text{Rape}$\n\n. . .\n\n\n<!-- - The sign just change the direction, not the angle. -->\n\n- We have 4 PCs because $\\min(n-1, p) = \\min(50-1, 4) = 4$.\n\n::: notes\n- To perform PCA in R, it cannot be easier. \n- We just need to use the function prcomp(), and put the data set in the function. Then we get everything we want.\n- Here I choose to scale the data because variables are not measured in the same scale. For example, Murder rate and UrbanPop are measured in different units. \n- This makes sure that every variable has variance 1, and our analysis is not affected by units.\n- The PCA results are stored as a list in pca_output object.\n- OK first we can look at the rotation matrix because it provides PC loadings, and so we know what PC1 and PC2 are.\n- Changing signs for easier interpretation of PCs\n- Those PC loadings define how we rotates the coordinates to obtain the PCs.\n???\n- Again, PC1 is just a linear combination or weighted average of the 4 variables, same as PC2.\n???\n- Again, PC1 is just a linear combination or weighted average of the 4 variables, same as PC2.\n- PCs are unique up to a sign change, so `-pca_output$rotation` gives us the same PCs as `pca_output$rotation` does.\n- We have 4 PCs because $\\min(n-1, k) = \\min(50-1, 4) = 4$.\n:::\n\n## PC Scores\n\n- The value of the *rotated* data, the data values of each PC are stored in `pca_output$x`\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(pca_output$x <- -pca_output$x, 16) |> round(2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```{.my_class800}\n              PC1   PC2   PC3   PC4\nAlabama      0.98  1.12 -0.44 -0.15\nAlaska       1.93  1.06  2.02  0.43\nArizona      1.75 -0.74  0.05  0.83\nArkansas    -0.14  1.11  0.11  0.18\nCalifornia   2.50 -1.53  0.59  0.34\nColorado     1.50 -0.98  1.08  0.00\nConnecticut -1.34 -1.08 -0.64  0.12\nDelaware     0.05 -0.32 -0.71  0.87\nFlorida      2.98  0.04 -0.57  0.10\nGeorgia      1.62  1.27 -0.34 -1.07\nHawaii      -0.90 -1.55  0.05 -0.89\nIdaho       -1.62  0.21  0.26  0.49\nIllinois     1.37 -0.67 -0.67  0.12\nIndiana     -0.50 -0.15  0.23 -0.42\nIowa        -2.23 -0.10  0.16 -0.02\nKansas      -0.79 -0.27  0.03 -0.20\n```\n:::\n:::\n\n\n::: notes\n- The value of the *rotated* data, the data values of each PC are stored in `pca_output$x`.\n- In other words, PC1 column here shows the projected values of observations onto PC1. PC2 column shows the projected values of observations onto PC2, and so on.\n:::\n\n\n## Interpretation of PCs\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npca_output$rotation\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          PC1   PC2   PC3    PC4\nMurder   0.54  0.42 -0.34 -0.649\nAssault  0.58  0.19 -0.27  0.743\nUrbanPop 0.28 -0.87 -0.38 -0.134\nRape     0.54 -0.17  0.82 -0.089\n```\n:::\n:::\n- PCs are less interpretable than original features. \n\n- The first loading vector places approximately equal weight on `Assualt`, `Murder` and `Rape`, with much less weights on `UrbanPop`.\n\n- PC1 roughly corresponds to a **overall serious crime rate**.\n\n. . .\n\n- The second loading vector places most of its weight on `UrbanPop`, and much less weight on the other 3 features.\n\n- PC2 roughly corresponds to the **level of urbanization**.\n\n\n::: notes\n- Intepretability decreases with the order of PCs.\n- So it's easier to give PC1 a meaningful name than PC2, and PC2 is more meaningful than PC3, and so on. Because the PCs after the first 2 PCs usually explain quite small variation in the data, and some of them may be just noises.\n- Let's see if we can interpret these PCs.\n- First keep in mind that PCs are less interpretable than original features. Sometimes we even don't know how to interpret it, especially for PCs that explain small variations. So this is the price we pay for dimension reduction.\n- But let's look at this example.\n- The first loading vector places approximately equal weight on `Assualt`, `Murder` and `Rape`, with much less weights on `UrbanPop`.\n- So PC1 roughly corresponds to a **overall serious crime rate** because PC1 explains the variations of data caused by those crime variables `Assualt`, `Murder` and `Rape`.\n- On the contrary, the second loading vector places most of its weight on `UrbanPop`, and much less weight on the other 3 features.\n- So we can say PC2 roughly corresponds to the **level of urbanization**.\n- So you get the idea, `Assualt`, `Murder` and `Rape` are similar each other because they all are measures of crime rate.\n- So when reducing dimensions, we sort of combine the three similar variables together to become a one single index that measures an overall crime rate.\n- Urban population measures a totally different thing. So the variation created by this variable cannot be explained well by the crime rate, and it should be absorbed in PC2.\n:::\n\n\n## 2D Representation of the 4D data\n:::: {.columns}\n\n::: {.column width=\"45%\"}\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npca_output$x |> tail(2) |> round(2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            PC1   PC2   PC3   PC4\nWisconsin -2.06 -0.61 -0.14 -0.18\nWyoming   -0.62  0.32 -0.24  0.16\n```\n:::\n:::\n\n<!-- # ```{r, eval=F} -->\n<!-- # #| echo: true -->\n<!-- # plot(x = pca_output$x[, 1],  -->\n<!-- #      y = pca_output$x[, 2], cex = 0,  -->\n<!-- #      xlim = c(-3, 3), ylim = c(-3, 3),  -->\n<!-- #      xlab = \"PC1 (crime index)\",  -->\n<!-- #      ylab = \"PC2 (urbanization index)\") -->\n<!-- # text(x = pca_output$x[, 1],  -->\n<!-- #      y = pca_output$x[, 2],  -->\n<!-- #      labels = state.abb) -->\n<!-- # ``` -->\n<!-- # ```{r} -->\n<!-- # #| echo: true -->\n<!-- # wi_pc <- pca_output$x[row.names(pca_output$x) -->\n<!-- #                       == \"Wisconsin\", ] -->\n<!-- # round(wi_pc, 3) -->\n<!-- # ``` -->\n- Higher value of PC1 means higher crime rate (roughly).\n\n- Higher value of PC2 means higher level of urbanization (roughly).\n:::\n\n\n::: {.column width=\"55%\"}\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-38-1.png){fig-align='center' width=100%}\n:::\n:::\n:::\n::::\n\n::: notes\n- And we can show our 2D Representation of the 4D data. \n- Higher value of PC1 means higher crime rates (roughly).\n- Higher value of PC2 means higher level of urbanization (roughly).\n- We may be able to further analysis on the reduced dimension data, for example, we may want to partition the data into 2 clusters.\n- One cluster has high crime rate and low urbanization, the other group shows low crime rate and high urbanization.\n- One cluster may be the low economically-developed states, and the other high economically-developed states.\n- So you see, we can tell lots of stories by analyzing our data.\n:::\n\n\n## 2D Representation of the 4D data: biplot\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbiplot(pca_output, xlabs = state.abb, \n       scale = 0)\n```\n:::\n- Top axis: PC1 loadings\n- Right axis: PC2 loadings\n- Red arrows: PC1 and PC2 loading vector, e.g., (0.28, 0.87) for `UrbanPop`.\n- Crime-related variables (`Assualt`, `Murder` and `Rape`) are located close to each other.\n- `UrbanPop` is far from the other three.\n- `Assualt`, `Murder` and `Rape` are more correlated, and `UrbanPop` is less correlated with the other three.\n:::\n\n\n\n::: {.column width=\"50%\"}\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/biplot-1.png){fig-align='center' width=100%}\n:::\n:::\n:::\n::::\n\n\n::: notes\n- We can simply use the function biplot() to show the 2D Representation of the data. \n- This function also provide loading vector of PC1 and PC2 that gives us an idea of which direction means a large value of a variable/feature.\n- This is why it is called biplot because we plot two things in one single plot.\n- Here, Top axis is for PC1 loadings\n- Right axis is PC2 loadings\n- Red arrows: PC1 and PC2 loading vector, e.g., (0.28, 0.87) for `UrbanPop`.\n- So NJ and Ca have pretty high urban pop rate because they are large in the `UrbanPop` arrow direction. \n- Crime-related variables (`Assualt`, `Murder` and `Rape`) are located close to each other.\n- `UrbanPop` is far from the other three.\n- `Assualt`, `Murder` and `Rape` are more correlated, and `UrbanPop` is less correlated with the other three.\n- `Assualt`, `Murder` and `Rape` sort of point to the same direction as PC1 and `UrbanPop` points to the same direction as PC2.\n:::\n\n\n## Proportion of Variance Explained\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsummary(pca_output)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nImportance of components:\n                        PC1   PC2    PC3    PC4\nStandard deviation     1.57 0.995 0.5971 0.4164\nProportion of Variance 0.62 0.247 0.0891 0.0434\nCumulative Proportion  0.62 0.868 0.9566 1.0000\n```\n:::\n:::\n\n\n- PC1 explains $62\\%$ of the variations in the data, and PC2 explains $24.7\\%$ of the variance.\n- PC1 and PC2 explain about $87\\%$ of the variance, and the last two PCs explain only $13\\%$.\n- 2D plot provides pretty accurate summary of the data.\n\n::: notes\n<!-- # (pc_var <- pca_output$sdev ^ 2) -->\n<!-- # (pc_var_prop <- pc_var / sum(pc_var)) -->\n- Finally I want to talk a little bit about Proportion of Variance Explained.\n- In the pca_output, we have SD of each PC.\n- We square it to get variance.\n- Then if we divided by the sum of variance, we get the Proportion of Variance Explained by each PC.\n- So PC1 explains $62\\%$ of the variations in the data, and PC2 explains $24.7\\%$ of the variance.\n- PC1 and PC2 explain about $87\\%$ of the variance, and the last two PCs explain only $13\\%$.\n- 2D plot provides pretty accurate summary of the data.\n:::\n\n## Scree Plot\n\nLook for a point at which the proportion of variance explained by each subsequent PC drops off.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/screeplot-1.png){fig-align='center' width=48%}\n:::\n:::\n\n\n::: notes\n- Finally we can plot the proportion of variance explained by PCs. The plot is called scree plot.\n- We can Look for a point at which the proportion of variance explained by each subsequent PC drops off.\n- and learn how many PCs we need to appropriately represent a high-dimensional data set.\n:::\n\n## PCA with Tidymodels {visibility=\"hidden\"}\n\nCheck <https://recipes.tidymodels.org/reference/step_pca.html>\n\n\n##\n\n::: {.lab}\n\n<span style=\"color:blue\"> **23-Principal Component Analysis** </span>\n\nIn **lab.qmd** `## Lab 23` section, \n\n1. Use `slice()` to print the first six rows of `iris` data.\n\n2. Perform PCA on `Sepal.Length`, `Sepal.Width`, `Petal.Length`, and `Petal.Width`.\n\n3. Generate biplot, and explain it.\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n```\n:::\n:::\n\n:::\n\n##\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-41-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n##\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/19-pcs/unnamed-chunk-42-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n# {background-color=\"#ffde57\" background-image=\"https://upload.wikimedia.org/wikipedia/commons/0/05/Scikit_learn_logo_small.svg\" background-size=\"40%\" background-position=\"90% 50%\"}\n\n\n::: {.left}\n<h1> sklearn.decomposition </h1>\n<h1> sklearn.preprocessing </h1>\n\n:::\n\n\n##\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\nimport numpy as np\nimport pandas as pd\nfrom sklearn.decomposition import PCA\nfrom sklearn.preprocessing import StandardScaler\n```\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\nUSArrests = pd.read_csv('https://raw.githubusercontent.com/vincentarelbundock/Rdatasets/master/csv/datasets/USArrests.csv')\nUSArrests.head(4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   rownames  Murder  Assault  UrbanPop  Rape\n0   Alabama    13.2      236        58  21.2\n1    Alaska    10.0      263        48  44.5\n2   Arizona     8.1      294        80  31.0\n3  Arkansas     8.8      190        50  19.5\n```\n:::\n:::\n\n. . .\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\nUSArr = USArrests.drop(['rownames'], axis = 1)\nUSArr.index = USArrests['rownames']\nUSArr.head(4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Murder  Assault  UrbanPop  Rape\nrownames                                 \nAlabama     13.2      236        58  21.2\nAlaska      10.0      263        48  44.5\nArizona      8.1      294        80  31.0\nArkansas     8.8      190        50  19.5\n```\n:::\n:::\n\n\n::: notes\nhttps://stackoverflow.com/questions/68275857/urllib-error-urlerror-urlopen-error-ssl-certificate-verify-failed-certifica\n:::\n\n\n## \n\n- **Standardization**\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\nscaler = StandardScaler()\nX = scaler.fit_transform(USArr.values) ## Array\n```\n:::\n\n. . .\n\n- **Perform PCA** (`prcomp(USArrests, scale = TRUE)`)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\npca = PCA(n_components=4)\npca.fit(X)\n```\n\n::: {.cell-output-display}\n```{=html}\n<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>PCA(n_components=4)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">PCA</label><div class=\"sk-toggleable__content\"><pre>PCA(n_components=4)</pre></div></div></div></div></div>\n```\n:::\n:::\n\n. . .\n\n- **PCA Components** (`pca_output$rotation`)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\nresult = np.round(pca.components_.T, 2)\npd.DataFrame(result, columns=['PC1', 'PC2', 'PC3', 'PC4'], index=USArr.columns)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           PC1   PC2   PC3   PC4\nMurder    0.54  0.42 -0.34  0.65\nAssault   0.58  0.19 -0.27 -0.74\nUrbanPop  0.28 -0.87 -0.38  0.13\nRape      0.54 -0.17  0.82  0.09\n```\n:::\n:::\n\n\n## \n\n\n- **Data on PCs** (`pca_output$x`)\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\nX_pc = np.round(pca.transform(X), 2)\npd.DataFrame(X_pc, columns=['PC1', 'PC2', 'PC3', 'PC4'], index=USArr.index)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 PC1   PC2   PC3   PC4\nrownames                              \nAlabama         0.99  1.13 -0.44  0.16\nAlaska          1.95  1.07  2.04 -0.44\nArizona         1.76 -0.75  0.05 -0.83\nArkansas       -0.14  1.12  0.11 -0.18\nCalifornia      2.52 -1.54  0.60 -0.34\nColorado        1.51 -0.99  1.10  0.00\nConnecticut    -1.36 -1.09 -0.64 -0.12\nDelaware        0.05 -0.33 -0.72 -0.88\nFlorida         3.01  0.04 -0.58 -0.10\nGeorgia         1.64  1.28 -0.34  1.08\nHawaii         -0.91 -1.57  0.05  0.90\nIdaho          -1.64  0.21  0.26 -0.50\nIllinois        1.38 -0.68 -0.68 -0.12\nIndiana        -0.51 -0.15  0.23  0.42\nIowa           -2.25 -0.10  0.16  0.02\nKansas         -0.80 -0.27  0.03  0.21\nKentucky       -0.75  0.96 -0.03  0.67\nLouisiana       1.56  0.87 -0.78  0.45\nMaine          -2.40  0.38 -0.07 -0.33\nMaryland        1.76  0.43 -0.16 -0.56\nMassachusetts  -0.49 -1.47 -0.61 -0.18\nMichigan        2.11 -0.16  0.38  0.10\nMinnesota      -1.69 -0.63  0.15  0.07\nMississippi     1.00  2.39 -0.74  0.22\nMissouri        0.70 -0.26  0.38  0.23\nMontana        -1.19  0.54  0.25  0.12\nNebraska       -1.27 -0.19  0.18  0.02\nNevada          2.87 -0.78  1.16  0.31\nNew Hampshire  -2.38 -0.02  0.04 -0.03\nNew Jersey      0.18 -1.45 -0.76  0.24\nNew Mexico      1.98  0.14  0.18 -0.34\nNew York        1.68 -0.82 -0.64 -0.01\nNorth Carolina  1.12  2.23 -0.86 -0.95\nNorth Dakota   -2.99  0.60  0.30 -0.25\nOhio           -0.23 -0.74 -0.03  0.47\nOklahoma       -0.31 -0.29 -0.02  0.01\nOregon          0.06 -0.54  0.94 -0.24\nPennsylvania   -0.89 -0.57 -0.40  0.36\nRhode Island   -0.86 -1.49 -1.37 -0.61\nSouth Carolina  1.32  1.93 -0.30 -0.13\nSouth Dakota   -1.99  0.82  0.39 -0.11\nTennessee       1.00  0.86  0.19  0.65\nTexas           1.36 -0.41 -0.49  0.64\nUtah           -0.55 -1.47  0.29 -0.08\nVermont        -2.80  1.40  0.84 -0.14\nVirginia       -0.10  0.20  0.01  0.21\nWashington     -0.22 -0.97  0.62 -0.22\nWest Virginia  -2.11  1.42  0.10  0.13\nWisconsin      -2.08 -0.61 -0.14  0.18\nWyoming        -0.63  0.32 -0.24 -0.17\n```\n:::\n:::\n\n- **Explained Variance** (`pca_output$sdev ^ 2`)\n\n::: {.cell layout-align=\"center\"}\n\n```{.python .cell-code}\nnp.round(pca.explained_variance_, 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\narray([2.53, 1.01, 0.36, 0.18])\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}